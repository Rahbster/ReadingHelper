<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reading Helper</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <meta name="theme-color" content="#A9C9FF"/>
</head>
<body>

    <header>
        <h1>Reading Helper</h1>
        <div class="header-buttons">
            <button id="choose-story-btn" class="theme-button">Choose a Story</button>
            <button id="toggle-dashboard-btn" class="theme-button">Dashboard</button>
        </div>
    </header>

    <main>
        <div id="reader-view">
            <div id="creator-area" class="input-area hidden">
                <textarea id="story-input" placeholder="Paste a story here..."></textarea>
                <div class="json-editors">
                    <div class="json-editor">
                        <label>Phonetics Guide</label>
                        <div id="phonetics-editor"></div>
                        <button id="add-phonetic-btn" class="theme-button">Add Phonetic</button>
                    </div>
                    <div class="json-editor">
                        <label>Pronunciation Guide</label>
                        <div id="pronunciations-editor"></div>
                        <button id="add-pronunciation-btn" class="theme-button">Add Pronunciation</button>
                    </div>
                </div>
                <div class="input-buttons">
                    <button id="load-to-edit-btn" class="theme-button">Load to Edit</button>
                    <button id="add-image-btn" class="theme-button">Add Image</button>
                    <button id="save-story-btn" class="theme-button">Save Story</button>
                </div>
            </div>
            <div id="story-display" class="story-container">
                <p>The story will appear here. Tap on any word to hear it read aloud.</p>
            </div>
        </div>

        <div id="dashboard-view" class="hidden">
            <h2>Tricky Words</h2>
            <p>This list shows the words that have been tapped the most, helping you see where to focus.</p>
            <div class="dashboard-controls">
                <button id="creator-mode-btn" class="theme-button">Enter Creator Mode</button>
                <button id="clear-stats-btn" class="theme-button">Clear Word Stats</button>
                <button id="reset-app-btn" class="theme-button destructive">Reset App</button>
            </div>
            <div id="tricky-words-list">
                <!-- Word stats will be populated here by JavaScript -->
            </div>
        </div>
    </main>

    <!-- Story Library Modal -->
    <div id="story-modal" class="modal hidden">
        <div class="modal-content">
            <h2>Choose a Story</h2>
            <div id="story-list">
                <!-- Story links will be populated here -->
            </div>
            <hr>
            <h4>Or Load from...</h4>
            <div class="load-options">
                <button id="load-from-computer-btn" class="theme-button">Load from Computer</button>
                <button id="load-from-url-btn" class="theme-button">Load from Web...</button>
            </div>
            <br>
            <button id="close-story-modal-btn" class="theme-button">Close</button>
        </div>
    </div>

    <!-- Syllable breakdown pop-up -->
    <div id="syllable-popup" class="syllable-popup hidden"></div>

    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js').then(registration => {
                    console.log('ServiceWorker registration successful with scope: ', registration.scope);
                }, err => {
                    console.log('ServiceWorker registration failed: ', err);
                });
            });
        }
    </script>
    <script src="js/main.js" type="module"></script>

</body>
</html>